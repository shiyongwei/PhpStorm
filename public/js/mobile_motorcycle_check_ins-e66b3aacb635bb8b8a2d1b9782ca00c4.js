ER.require("ER.MobileMotorcycleCheckIns",function(){var e={},i=null,t=function(e){n(e),s(),r(),a()};e.init=t;var n=function(e){i=e.buttonImage},s=function(){$(".js-location").click(function(){var e=$(this);d(e.attr("data-name"),e.attr("data-providerId"))})},r=function(){var e=$(".js-lookup");o(e),c()},a=function(){var e=$(".js-reservation-details");e.find(".js-additional").click(function(){e.find(".js-additonal_forms").hide(),e.find("form[data-radio="+$(this).attr("id")+"]").show()}),$(".js-pickupLocName").on("click",function(){$(".js-overlay-Locations-pickUp").foundation("open")}),Materialize.updateTextFields(),o(e),o($(".js-additonal_forms")),e.find('input[type="radio"]:checked').trigger("click"),j()},o=function(e){null==e&&(e=$(document)),e.find(".js-date.js-future").pickadate({selectMonths:!0,selectYears:100,min:!0,max:new Date(2050,1,1),format:"mm/dd/yyyy",onSet:function(e){"select"in e&&this.close()}});var i=new Date;e.find(".js-date.js-dob").pickadate({selectMonths:!0,selectYears:100,min:new Date(1900,1,1),max:new Date(i.getFullYear()-21,i.getMonth(),i.getDate()),format:"mm/dd/yyyy",onSet:function(e){"select"in e&&this.close()}})},d=function(e,i){$(".js-pickupLocName").val(e),$(".js-pickupLocCode").val(i),Materialize.updateTextFields(),$(".js-overlay-Locations-pickUp").foundation("close")},c=function(){$(".js-lookupTrigger").submit(function(e){e.preventDefault(),$(".js-loader").show(),$.ajax({type:$(this).attr("method"),url:$(this).attr("action")+".mobile",data:$(this).serialize(),dataType:"json",success:function(e){$(".js-reservation-details").remove();var i=null;$(".js-reservation-details").remove();var i;1==e.error?(i=".js-error-alert",ER.Notifications.showErrorMessage(e.msg)):($(i).hide(),$(".js-error-alert").hide(),$(".js-lookup").hide(),$(".js-main-container").removeClass("row"),$(".js-checkin-intro").hide(),$(".js-checkin_form").append(e.reservation_details),i=".js-reservation-details",a()),"undefined"!=typeof $(i)[0]&&$("html, body").animate({scrollTop:$(i).offset().top},100),l()},statusCode:{404:function(){alert("record not found")}},complete:function(){$(".js-loader").hide()}})})},l=function(){$(".js-submitAction").click(function(e){e.preventDefault();var i=$(".js-page"),t=$(this.form),n=i.find(".js-privacyPolicyCheckbox");return n.is(":checked")?(t.find(".js-spinner").show(),f(),params=p(t.serialize()),void $.ajax({url:t.attr("action"),type:"POST",data:params,dataType:"json",success:function(e){1==e.error?(displayedContainer=".js-error-alert",ER.Notifications.showErrorMessage(e.msg),Object.keys(e.rider_errors).length>0&&u($(".js-rider-form"),e.rider_errors),Object.keys(e.additional_rider_errors).length>0&&u($(".js-additional_rider-form"),e.additional_rider_errors)):window.location.replace(e.content)},statusCode:{404:function(){alert("record not found")}},complete:function(){t.find(".js-spinner").hide()}})):(alert("You must read & agree to Eaglerider Privacy Policy"),!1)})},u=function(e,i){for(var t in i){var n=e.find("[data-field="+t+"]"),s=n.parent();i[t].length>0&&!n.is(".is-invalid-input")&&!s.is(".is-invalid-input")?n.is("select")?(s.addClass("is-invalid-input"),n.parents(".js-dropdown-container").append('<span class="form-error js-error is-visible">'+i[t]+"</span>")):(n.addClass("is-invalid-input"),s.append('<span class="form-error js-error is-visible">'+i[t]+"</span>")):n.is("select")?(s.removeClass("is-invalid-input"),n.parents(".js-dropdown-container").find(".js-error").html("")):(n.removeClass("is-invalid-input"),s.find(".js-error").html(""))}"undefined"!=typeof i.terms_and_conditions&&$(".js-TermsAndConditionInput").find(".js-error").html($.unique(i.terms_and_conditions).join(" & "))},f=function(){if($("form[data-paramKey]:visible").each(function(){var e=$(this);e.find("[name]").each(function(){var e=$(this),i=$("<input>").attr("type","hidden").attr("name",e.attr("name")).val(e.val());i.insertBefore(".js-submitAction")})}),$(".js-lookupTrigger .js-identifierField").val().length>0)var e=$(".js-lookupTrigger .js-identifierField").parents("form");else var e=$(".js-lookupTrigger .js-date").parents("form");e.find("[name]").each(function(){var e=$(this),i=$("<input>").attr("type","hidden").attr("name",e.attr("name")).val(e.val());i.insertBefore(".js-submitAction")})},p=function(e){return e+="&receive_er_emails="+$(".js-receive-er-emails").prop("checked"),e+="&accept_terms_and_conditions="+$(".js-AcceptTermsAndConditions").prop("checked")},j=function(){var e=$(".search");e.dropdown(),$(".js-additonal_forms").each(function(){var e=$(this);new CascadedSelects(e,[".js-countriesSelect",".js-regionsSelect"]),new CascadedSelects(e,[".js-licenseCountriesSelect",".js-licenseRegionsSelect"])}),$(".js-riderInfo").each(function(){var e=$(this);new CascadedSelects(e,[".js-countriesSelect",".js-regionsSelect"]),new CascadedSelects(e,[".js-licenseCountriesSelect",".js-licenseRegionsSelect"])}),$(".js-endorsement-select").change(function(){var e=$("option:selected",$(this)).val();"true"==e?($(this).closest(".js-dropdown-container").next(".js-endorsement-message").hide(),$(this).removeClass("warning-input")):($(this).closest(".js-dropdown-container").next(".js-endorsement-message").show(),$(this).addClass("warning-input"))})};return e}());